# WebAssembly
<br/><br/>
This is a project to test out `WebAssembly`.
<br/><br/>

[Link to rust documentation](https://docs.rs/web-assembly-whipshout/0.9.0/web_assembly_whipshout/)
<br/>

[Link to npm package generated by this project](https://www.npmjs.com/package/web-assembly-whipshout)
<br/><br/>
# JS/TS code to test the library
<br/>

- First install package => `npm i web-assembly-whipshout`
<br/><br/>
- Copy and paste the code from below
<br/><br/>
# Info
<br/>

- Rust generates *.d.ts with types for TS
<br/><br/>
- JS values returned block uses JS variable types
<br/><br/>
- Rust values returned block uses Rust variable types
<br/><br/>
- Provider.new creates a new object using a Rust struct
<br/><br/>
- Cannot get the data from the provider directly like in JS, we have to use Rust methods declared in the Struct to get the data
<br/><br/>
- Remove comments of the for loop to test performance of fibonacci in Rust and JS (with 50 iterations takes a lot of time)
<br/><br/><br/>

```
import {Provider, fibonacci, parse_string, parse_string_option} from 'web-assembly-whipshout';

// JS values returned
let js_ok = parse_string("6")
let js_fail = parse_string("hello")

// Rust values returned
let rust_ok = parse_string_option("7")
let rust_fail = parse_string_option("world")

console.log("---------")
console.log("---------")
console.log(js_ok)
console.log(js_fail)
console.log("---------")
console.log("---------")
console.log(rust_ok)
console.log(rust_fail)
console.log("*********")
console.log("*********")
// -------------------------

const provider = Provider.new(123, "Magic")
const id = provider.get_id()
const name = provider.get_name()

// Returns the structure with a pointer
console.log(provider)
// Returns the correct info, needed specific methods to extract it
console.log(id)
console.log(name)
console.log("*********")
console.log("*********")
// -------------------------

function fibonacciJS(x: number): number {
if (x === 0) {
return 0
}

if (x === 1) {
return 1
}

return fibonacciJS(x - 1) + fibonacciJS(x - 2)
}

// Test performance (rust > js, around +35 rust gets so much much much better)
// Shows execution times for each step, left rust, right js
// for (let i = 0; i < 50; i++) {
//   const wasmStart = Date.now()
//   fibonacci(i)
//   const wasmDuration = Date.now() - wasmStart
//
//   const jsStart = Date.now()
//   fibonacciJS(i)
//   const jsDuration = Date.now() - jsStart
//
//   console.log(`${i},${wasmDuration},${jsDuration}`)
// }
```